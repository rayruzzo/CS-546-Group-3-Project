<div class="dm-page">
  <div class="dm-container">

    <div class="dm-card">
      <a href="/dmthreads" class="dm-back-link">Back to Messages</a>
      <h2 class="dm-heading">Start a New Conversation</h2>

      <form method="POST" action="/dmthreads/create" class="dm-form">

        <div class="dm-field">
          <label for="recipient">Recipient Username</label>
          <input 
            type="text"
            id="recipient"
            name="recipient"
            value="{{previousRecipient}}"
            placeholder="e.g. starspangledman"
            required
          >

          {{!-- Shared inline error (server + client) --}}
          {{#if error}}
            <div id="username-error-text" class="dm-inline-error">{{error}}</div>
          {{else}}
            <div id="username-error-text" class="dm-inline-error" style="display:none;"></div>
          {{/if}}
        </div>

        <div class="dm-field">
          <label for="message">Initial Message</label>
          <textarea 
            id="message" 
            name="message" 
            rows="4"
            placeholder="Say something friendly…"
            required
          >{{previousMessage}}</textarea>

          {{#if errorMessage}}
            <div class="dm-inline-error">{{errorMessage}}</div>
          {{/if}}

          <div id="message-counter" class="dm-char-counter">0 / 2000</div>
        </div>

        <button class="dm-submit-btn" type="submit">
          Start Conversation →
        </button>

      </form>
    </div>

  </div>
</div>

<script src="/public/js/dmCreateValidation.js"></script>